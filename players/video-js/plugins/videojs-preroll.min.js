/*! videojs-preroll - v0.2.0 - 2014-12-19
* Copyright (c) 2014 Sano Webdevelopment;
* Copyright (c) 2014 The Onion
* Licensed MIT */
!function(r,e){"use strict";var l,o={src:"",href:"",target:"_blank",allowSkip:!0,skipTime:5,repeatAd:!1};l=function(l){var n=e.util.mergeOptions(o,l),t=this;t.preroll={adDone:!1},t.on("contentupdate",function(){t.trigger(t.preroll.shouldPlayPreroll()?"adsready":"adscanceled")}),t.on("readyforpreroll",function(){if(!t.preroll.shouldPlayPreroll())return void t.trigger("adscanceled");if(t.ads.startLinearAdMode(),t.src(n.src),t.one("durationchange",function(){t.play()}),t.one("progress",function(){t.play()}),""!==n.href){var e=document.createElement("a");e.className="preroll-blocker",e.href=n.href,e.target=n.target||"_blank",e.onclick=function(){t.trigger("adclick")},t.preroll.blocker=e,t.el().insertBefore(e,t.controlBar.el())}if(n.allowSkip!==!1){var l=document.createElement("div");l.className="preroll-skip-button",t.preroll.skipButton=l,t.el().appendChild(l),l.onclick=function(e){var l=l||r.Event;return(" "+t.preroll.skipButton.className+" ").indexOf(" enabled ")>=0&&(t.preroll.exitPreroll(),t.trigger("ended")),void 0===l.prototype.stopPropagation?!1:void e.stopPropagation()},t.on("timeupdate",t.preroll.timeupdate)}t.one("ended",t.preroll.exitPreroll),t.one("error",t.preroll.prerollError)}),t.preroll.shouldPlayPreroll=function(){return""===n.src?!1:t.preroll.adDone===!0?!1:!0},t.preroll.exitPreroll=function(){"undefined"!=typeof t.preroll.skipButton&&t.preroll.skipButton.parentNode.removeChild(t.preroll.skipButton),"undefined"!=typeof t.preroll.blocker&&t.preroll.blocker.parentNode.removeChild(t.preroll.blocker),t.off("timeupdate",t.preroll.timeupdate),t.off("ended",t.preroll.exitPreroll),t.off("error",t.preroll.prerollError),n.repeatAd!==!0&&(t.preroll.adDone=!0),t.ads.endLinearAdMode()},t.preroll.timeupdate=function(){t.loadingSpinner.el().style.display="none";var r=Math.ceil(n.skipTime-t.currentTime());r>0?t.preroll.skipButton.innerHTML="Skip in "+r+"...":-1===(" "+t.preroll.skipButton.className+" ").indexOf(" enabled ")&&(t.preroll.skipButton.className+=" enabled",t.preroll.skipButton.innerHTML="Skip")},t.preroll.prerollError=function(){t.preroll.exitPreroll()},t.currentSrc()&&t.trigger(t.preroll.shouldPlayPreroll()?"adsready":"adscanceled")},e.plugin("preroll",l)}(window,window.videojs);